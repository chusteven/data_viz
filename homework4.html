<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>MSAN 622 Information Visualization</title>

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap-theme.min.css" rel="stylesheet">

<style type="text/css">
    body {
        padding-top: 50px;
        padding-bottom: 20px;
    }
</style>


</head>

<body>

<!-- this is defining the style for the objects we will have populating our page -->
<style>


/*for bar chart of lengths*/
svg#barlength body {
  font: 10px sans-serif;
}

svg#barlength .axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

svg#barlength .axis text {
    font-family: sans-serif;
    font-size: 10px;
}

svg#barlength .bar {
  fill: steelblue;
}

svg#barlength .x.axis path {
  display: none;
}


/*for bar chart of budgets*/
svg#barbudget body {
  font: 10px sans-serif;
}

svg#barbudget .axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

svg#barbudget .axis text {
    font-family: sans-serif;
    font-size: 10px;
}

svg#barbudget .bar {
  fill: steelblue;
}

svg#barbudget .x.axis path {
  display: none;
}


/*for line chart of average rating*/
svg#avgrating body {
  font: 10px sans-serif;
}

svg#avgrating .axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

svg#avgrating .axis text {
    font-family: sans-serif;
    font-size: 10px;
}

svg#avgrating .line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}


/*for line chart of average votes*/
svg#avgvotes body {
  font: 10px sans-serif;
}

svg#avgvotes .axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

svg#avgvotes .axis text {
    font-family: sans-serif;
    font-size: 10px;
}

svg#avgvotes .line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}

</style>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">MSN 622</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="#homework">Homework</a></li>
                <li><a href="#project">Project</a></li>
                <li><a href="#participation">Participation</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">

    <!-- title for homework -->
    <div class="row" style="text-align:center;">
        <h1>Homework 4: Movies Dashboard</h1>
        <p>This page is for Steven Chu's fourth MSAN 622 homework assignment. Source code can be found in my <a href="https://github.com/chusteven/spring-2015-msan622/blob/gh-pages/homework4.html">github respository</a>.</p>
    </div>

</div>

<div class="container">

    <div class="row">

        <div class="media-body" id="userguide">

            <h2 class="page-header">A Brief User Guide</h2>

            <p>The following visualizations are somewhat straightforward in terms of how to interact with them. The basic visualization has simple hover-over options to display exact values. The moderate functionality has no interactivity, however.</p>

        </div>

    </div>

</div>

<div class="container">

    <div class="row">

        <div class="media-body" id="basic">

            <h2 class="page-header">Basic Functionality</h2>

            <p>The following visualization was implemented in Tableau Public.</p>

            <script type='text/javascript' src='https://public.tableau.com/javascripts/api/viz_v1.js'></script>

                <div class='tableauPlaceholder' style='width: 940px; height: 550px;'>
                    <noscript>
                        <a href='#'>
                            <img alt='Dashboard 1 ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;ho&#47;homework4_2&#47;Dashboard1&#47;1_rss.png' style='border: none' />
                        </a>
                    </noscript>
                    <object class='tableauViz' width='944' height='551' style='display:none;'>
                    <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                    <param name='site_root' value='' />
                    <param name='name' value='homework4_2&#47;Dashboard1' />
                    <param name='tabs' value='no' />
                    <param name='toolbar' value='yes' />
                    <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;ho&#47;homework4_2&#47;Dashboard1&#47;1.png' /> 
                    <param name='animate_transition' value='yes' />
                    <param name='display_static_image' value='yes' />
                    <param name='display_spinner' value='yes' />
                    <param name='display_overlay' value='yes' />
                    <param name='display_count' value='yes' />
                    <param name='showVizHome' value='no' />
                    <param name='showTabs' value='y' />
                    <param name='bootstrapWhenNotified' value='true' />
                </object>
            </div>

        </div>

    </div>

    <div class="row">

        <div class="media-body" id="moderate">

            <h2 class="page-header">Moderate Functionality</h2>

            <p>The two graphs on the left are simple grouped bar charts, while the two graphs on the right are simple line charts of average metrics per year.</p>

                <div id="block">
                    <svg id="barlength" class="med" width="10" height="10"></svg>
                    <svg id="avgvotes" class="medsmall" width="10" height="10"></svg>
                    <svg id="barbudget" class="med" width="10" height="10"></svg>
                    <svg id="avgrating" class="medsmall" width="10" height="10"></svg>
                </div>

        </div>

    </div>

</div>

<div class="container">

    <div class="row">

        <div class="media-body" id="preprocessing">
            
            <h2 class="page-header">Pre-Processing</h1>

            <p>I used R to preprocess the data so as to get rid of rows that didn't have any information in the budget column. To get the metrics in a more easily-accessible format for D3, I imported the dataset resulting from the R cleaning into a MySQL server and ran a few aggregate functions.</p>

        </div>

    </div>

    <div class="row">

        <div class="media-body" id="discussion">
            
            <h2 class="page-header">Discussion</h1>

            <p>I chose to visualize the information as presented above so as to capture information on a per-genre basis. For the two time-series plots, I wanted to break those line charts into multi-line charts - again, on a per-genre basis, with the added option of filtering, but did not have time. Furthermore, I chose to represent votes and ratings right above one another to make quick comparisons. For example, there may have been a year that received a high average rating but had a relatively low average number of votes. I wanted to make these comparisons easy to make. As far as the grouped bar plots go, I chose the two colors, orange and blue, so as to contrast the two groups.</p>

            <p>I think that my ultimate goal was to make all the graphs interact with each other. I was hoping that by selecting one genre at a time, I would be able to fade out all the other information on all the other graphs, so as to make quick comparisons between the various graphs. In any case, this is an opportunity I suppose I can explore another time.</p>

        </div>

    </div>

</div>


<footer>
    <p style="text-align: center;">Steven Chu &bullet; MSAN 622 Information Visualization &bullet; Spring 2015</p>
</footer>

</div>

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/d3.min.js"></script>

<script>



// helpful link for prototyping dashboard in Tableau
// http://onlinehelp.tableau.com/v9.0/public/online/mac/en-us/help.htm#dashboards.html

// select SVG by ID using "#"
d3.selectAll("svg.med")
    .attr("width", 540)
    .attr("height", 225);

// select SVGs by Class using "."
d3.selectAll("svg.medsmall")
    .attr("width", 400)
    .attr("height", 225);



// GROUPED BAR CHARTS - length by genre
// http://bl.ocks.org/mbostock/3887051
var marginbarl = {top: 20, right: 20, bottom: 30, left: 40},
    widthbarl = 540 - marginbarl.left - marginbarl.right,
    heightbarl = 225 - marginbarl.top - marginbarl.bottom;

var x0barl = d3.scale.ordinal()
    .rangeRoundBands([0, widthbarl], 0.1, 0.2);

var x1barl = d3.scale.ordinal();

var ybarl = d3.scale.linear()
    .range([heightbarl, 0]).nice();

var colorbarl = d3.scale.category10();

var xAxisbarl = d3.svg.axis()
    .scale(x0barl)
    .orient("bottom");

var yAxisbarl = d3.svg.axis()
    .scale(ybarl)
    .orient("left")
    .tickFormat(d3.format("d"));

var svgbarl = d3.select("#barlength")
  .append("g")
    .attr("transform", "translate(" + marginbarl.left + "," + marginbarl.top + ")");

d3.csv("genrebudgetlengths.csv", function(error, data) {
  var yesnobarl = ["NonLength", "Length"]

  data.forEach(function(d) {
    d.genres = yesnobarl.map(function(name) { return {name: name, value: +d[name]}; });
  });

  x0barl.domain(data.map(function(d) { return d.Genre; }));
  
  x1barl.domain(yesnobarl)
    .rangeRoundBands([0, x0barl.rangeBand()], 0.1, 0.2);

  ybarl.domain([0, d3.max(data, function(d) { return d3.max(d.genres, function(d) { return d.value; }); }) + 20]).nice();

  svgbarl.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + heightbarl + ")")
      .call(xAxisbarl);

  svgbarl.append("g")
      .attr("class", "y axis")
      .call(yAxisbarl)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .style("opacity", 0.7)
      .text("length (in minutes)");

  var genrebarl = svgbarl.selectAll(".genre")
      .data(data)
    .enter().append("g")
      .attr("class", "g")
      .attr("transform", function(d) { return "translate(" + x0barl(d.Genre) + ",0)"; });

  genrebarl.selectAll("rect")
      .data(function(d) { return d.genres; })
    .enter().append("rect")
      .attr("width", x1barl.rangeBand())
      .attr("x", function(d) { return x1barl(d.name); })
      .attr("y", function(d) { return ybarl(d.value); })
      .attr("height", function(d) { return heightbarl - ybarl(d.value); })
      .style("fill", function(d) { return colorbarl(d.name); });

  var legendbarl = svgbarl.selectAll(".legend")
      .data(yesnobarl.slice().reverse())
    .enter().append("g")
      .attr("class", "legend")
      .attr("transform", function(d, i) { return "translate(0," + i * 12 + ")"; });

  legendbarl.append("rect")
      .attr("x", widthbarl - 18)
      .attr("width", 10)
      .attr("height", 10)
      .style("fill", colorbarl);

  legendbarl.append("text")
      .attr("x", widthbarl - 20)
      .attr("y", 5)
      .attr("dy", ".35em")
      .style("font-size","10px")
      .style("text-anchor", "end")
      .style("opacity", 0.7)
      .text(function(d) {
        if (d == "Length") { return "Specified Genre"; }
        else { return "Other Genres"; }
      })


});



// GROUPED BAR CHARTS - budget by genre
// http://bl.ocks.org/mbostock/3887051
var marginbarb = {top: 20, right: 20, bottom: 30, left: 40},
    widthbarb = 540 - marginbarb.left - marginbarb.right,
    heightbarb = 225 - marginbarb.top - marginbarb.bottom;

var x0barb = d3.scale.ordinal()
    .rangeRoundBands([0, widthbarb], 0.1, 0.2);

var x1barb = d3.scale.ordinal();

var ybarb = d3.scale.linear()
    .range([heightbarb, 0]).nice();

var colorbarb = d3.scale.category10();

var xAxisbarb = d3.svg.axis()
    .scale(x0barb)
    .orient("bottom");

var yAxisbarb = d3.svg.axis()
    .scale(ybarb)
    .orient("left")
    .tickFormat(d3.format(".2s"));

var svgbarb = d3.select("#barbudget")
  .append("g")
    .attr("transform", "translate(" + marginbarb.left + "," + marginbarb.top + ")");

d3.csv("genrebudgetlengths.csv", function(error, data) {
  var yesnobarb = ["NonBudget", "Budget"]

  data.forEach(function(d) {
    d.budgets = yesnobarb.map(function(name) { return {name: name, value: +d[name]}; });
  });

  x0barb.domain(data.map(function(d) { return d.Genre; }));
  
  x1barb.domain(yesnobarb)
    .rangeRoundBands([0, x0barb.rangeBand()], 0.1, 0.2);

  ybarb.domain([0, d3.max(data, function(d) { return d3.max(d.budgets, function(d) { return d.value; }); })]).nice();

  svgbarb.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + heightbarb + ")")
      .call(xAxisbarb);

  svgbarb.append("g")
      .attr("class", "y axis")
      .call(yAxisbarb)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .style("opacity", 0.7)
      .text("budget (in dollars)");

  var genrebarb = svgbarb.selectAll(".genre")
      .data(data)
    .enter().append("g")
      .attr("class", "g")
      .attr("transform", function(d) { return "translate(" + x0barb(d.Genre) + ",0)"; });

  genrebarb.selectAll("rect")
      .data(function(d) { return d.budgets; })
    .enter().append("rect")
      .attr("width", x1barb.rangeBand())
      .attr("x", function(d) { return x1barb(d.name); })
      .attr("y", function(d) { return ybarb(d.value); })
      .attr("height", function(d) { return heightbarb - ybarb(d.value); })
      .style("fill", function(d) { return colorbarb(d.name); });

  var legendbarb = svgbarb.selectAll(".legend")
      .data(yesnobarb.slice().reverse())
    .enter().append("g")
      .attr("class", "legend")
      .attr("transform", function(d, i) { return "translate(0," + i * 12 + ")"; });

  legendbarb.append("rect")
      .attr("x", widthbarb - 18)
      .attr("width", 10)
      .attr("height", 10)
      .style("fill", colorbarb);

  legendbarb.append("text")
      .attr("x", widthbarb - 20)
      .attr("y", 5)
      .attr("dy", ".35em")
      .style("font-size","10px")
      .style("text-anchor", "end")
      .style("opacity", 0.7)
      .text(function(d) {
        if (d == "Budget") { return "Specified Genre"; }
        else { return "Other Genres"; }
      })

});



// TIME-SERIES PLOT - AVERAGE VOTES PER YEAR
// http://bl.ocks.org/mbostock/3883245
var marginlpv = {top: 20, right: 20, bottom: 30, left: 50},
    widthlpv = 400 - marginlpv.left - marginlpv.right,
    heightlpv = 225 - marginlpv.top - marginlpv.bottom;

var xlpv = d3.scale.linear()
    .range([0, widthlpv]);

var ylpv = d3.scale.linear()
    .range([heightlpv, 0]);

var xAxislpv = d3.svg.axis()
    .scale(xlpv)
    .orient("bottom")
    .tickFormat(d3.format("d"));

var yAxislpv = d3.svg.axis()
    .scale(ylpv)
    .orient("left");

var linelpv = d3.svg.line()
    .x(function(d) { return xlpv(d.year); })
    .y(function(d) { return ylpv(d.avgVotes); });

var svglpv = d3.select("#avgvotes")
  .append("g")
    .attr("transform", "translate(" + marginlpv.left + "," + marginlpv.top + ")");

d3.csv("ratingvotesbyyear.csv", function(error, data) {
  data.forEach(function(d) {
    d.year = +d.year;
    d.avgVotes = +d.avgVotes;
  });

  xlpv.domain(d3.extent(data, function(d) { return d.year; })).nice();
  ylpv.domain(d3.extent(data, function(d) { return d.avgVotes; })).nice();

  svglpv.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + heightlpv + ")")
      .call(xAxislpv);

  svglpv.append("g")
      .attr("class", "y axis")
      .call(yAxislpv)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .style("opacity", 0.7)
      .text("average number votes");

  svglpv.append("path")
      .datum(data)
      .attr("class", "line")
      .attr("d", linelpv);
});



// TIME-SERIES PLOT - AVERAGE RATING PER YEAR
// http://bl.ocks.org/mbostock/3883245
var marginlpr = {top: 20, right: 20, bottom: 30, left: 50},
    widthlpr = 400 - marginlpr.left - marginlpr.right,
    heightlpr = 225 - marginlpr.top - marginlpr.bottom;


var xlpr = d3.scale.linear()
    .range([0, widthlpr]);

var ylpr = d3.scale.linear()
    .range([heightlpr, 0]);

var xAxislpr = d3.svg.axis()
    .scale(xlpr)
    .orient("bottom")
    .tickFormat(d3.format("d"));

var yAxislpr = d3.svg.axis()
    .scale(ylpr)
    .orient("left");

var linelpr = d3.svg.line()
    .x(function(d) { return xlpr(d.year); })
    .y(function(d) { return ylpr(d.avgRating); });

var svglpr = d3.select("#avgrating")
  .append("g")
    .attr("transform", "translate(" + marginlpr.left + "," + marginlpr.top + ")");

d3.csv("ratingvotesbyyear.csv", function(error, data) {
  data.forEach(function(d) {
    d.year = +d.year;
    d.avgRating = +d.avgRating;
  });

  xlpr.domain(d3.extent(data, function(d) { return d.year; })).nice();
  ylpr.domain([0,10]).nice();

  svglpr.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + heightlpr + ")")
      .call(xAxislpr);

  svglpr.append("g")
      .attr("class", "y axis")
      .call(yAxislpr)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .style("opacity", 0.7)
      .text("average rating");

  svglpr.append("path")
      .datum(data)
      .attr("class", "line")
      .attr("d", linelpr);
});


</script>